<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeText - Resultados del An√°lisis</title>
    <link rel="stylesheet" href="../static/styles.css">
</head>
<body>
    <header>
        <div class="header-content">
            <h1>SafeText <span class="subtitle">Sistema de Detecci√≥n de Ciberacoso Escolar</span></h1>
        </div>
        <div class="header-year">
            <span>EPN 2025</span>
        </div>
    </header>

    <main>
        <div class="results-container">
            <!-- Secci√≥n de navegaci√≥n -->
            <div class="results-nav">
                <a href="index.html" class="btn-back">‚Üê Volver al An√°lisis</a>
                <h2>Resultados del An√°lisis</h2>
            </div>

            <!-- Texto analizado -->
            <div class="analyzed-text-section">
                <h3>Texto Analizado</h3>
                <div class="analyzed-text-box">
                    <p id="analyzed-text">
                        <!-- El texto analizado se mostrar√° aqu√≠ -->
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris.
                    </p>
                </div>
                <div class="text-stats">
                    <span class="stat-item">Caracteres: <strong id="char-count">127</strong></span>
                    <span class="stat-item">Palabras: <strong id="word-count">23</strong></span>
                    <span class="stat-item">L√≠neas: <strong id="line-count">3</strong></span>
                </div>
            </div>

            <!-- Resultados del an√°lisis -->
            <div class="analysis-results">
                <div class="results-summary">
                    <h3>Resumen del An√°lisis</h3>
                    <div class="summary-cards">
                        <div class="summary-card safe">
                            <div class="card-icon">‚úì</div>
                            <div class="card-content">
                                <h4>Contenido Seguro</h4>
                                <p class="percentage" id="safe-percentage">85%</p>
                                <p class="description">No se detectaron patrones de ciberacoso</p>
                            </div>
                        </div>
                        
                        <div class="summary-card warning">
                            <div class="card-icon">‚ö†</div>
                            <div class="card-content">
                                <h4>Contenido Sospechoso</h4>
                                <p class="percentage" id="warning-percentage">15%</p>
                                <p class="description">Algunos patrones requieren atenci√≥n</p>
                            </div>
                        </div>
                        
                        <div class="summary-card danger">
                            <div class="card-icon">‚úï</div>
                            <div class="card-content">
                                <h4>Contenido Peligroso</h4>
                                <p class="percentage" id="danger-percentage">0%</p>
                                <p class="description">Patrones de ciberacoso detectados</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Detalles de detecci√≥n -->
                <div class="detection-details">
                    <h3>Patrones Detectados</h3>
                    <div class="patterns-list" id="patterns-list">
                        <!-- Los patrones detectados se mostrar√°n aqu√≠ din√°micamente -->
                        <div class="pattern-item low-risk">
                            <div class="pattern-header">
                                <span class="pattern-type">Lenguaje Informal</span>
                                <span class="risk-level">Riesgo Bajo</span>
                            </div>
                            <div class="pattern-description">
                                <p>Se detect√≥ uso de lenguaje coloquial que podr√≠a interpretarse como agresivo en contexto formal.</p>
                                <div class="pattern-matches">
                                    <strong>Coincidencias encontradas:</strong>
                                    <span class="match-highlight">"ese tipo"</span>, 
                                    <span class="match-highlight">"no me molestes"</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="pattern-item medium-risk">
                            <div class="pattern-header">
                                <span class="pattern-type">Tono Agresivo</span>
                                <span class="risk-level">Riesgo Medio</span>
                            </div>
                            <div class="pattern-description">
                                <p>Identificadas expresiones con tono confrontativo que podr√≠an escalar a situaciones de acoso.</p>
                                <div class="pattern-matches">
                                    <strong>Coincidencias encontradas:</strong>
                                    <span class="match-highlight">"c√°llate"</span>, 
                                    <span class="match-highlight">"eres un idiota"</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recomendaciones -->
                <div class="recommendations">
                    <h3>Recomendaciones</h3>
                    <div class="recommendation-list">
                        <div class="recommendation-item">
                            <div class="rec-icon">üí°</div>
                            <div class="rec-content">
                                <h4>Supervisi√≥n Recomendada</h4>
                                <p>Se sugiere revisar manualmente el contenido identificado para determinar el contexto y la intenci√≥n real del mensaje.</p>
                            </div>
                        </div>
                        
                        <div class="recommendation-item">
                            <div class="rec-icon">üìö</div>
                            <div class="rec-content">
                                <h4>Educaci√≥n Preventiva</h4>
                                <p>Implementar programas de concientizaci√≥n sobre comunicaci√≥n digital responsable y respeto en l√≠nea.</p>
                            </div>
                        </div>
                        
                        <div class="recommendation-item">
                            <div class="rec-icon">üîÑ</div>
                            <div class="rec-content">
                                <h4>Monitoreo Continuo</h4>
                                <p>Establecer un sistema de seguimiento para evaluar la evoluci√≥n del comportamiento comunicativo.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Acciones -->
            <div class="results-actions">
                <button class="btn-secondary" id="export-report">üìÑ Exportar Reporte</button>
                <button class="btn-secondary" id="save-results">üíæ Guardar Resultados</button>
                <button class="btn-primary" id="new-analysis">üîç Nuevo An√°lisis</button>
            </div>
        </div>
    </main>

    <!-- Pie de p√°gina -->
    <footer>
        <div class="footer-content">
            <p>&copy; 2025 SafeText - Sistema de Detecci√≥n de Ciberacoso Escolar</p>
            <p>Creado por <strong>Harry Guajan</strong> y <strong>Joel Tinitana</strong></p>
            <p>Escuela Polit√©cnica Nacional (EPN) - Estructura de Datos y Algoritmos II</p>
            <div class="footer-links">
                <a href="#" class="footer-link">T√©rminos de Uso</a>
                <span class="separator">‚Ä¢</span>
                <a href="#" class="footer-link">Pol√≠tica de Privacidad</a>
                <span class="separator">‚Ä¢</span>
                <a href="#" class="footer-link">Contacto</a>
            </div>
        </div>
    </footer>

    <script>
        // Funcionalidad para los botones de acci√≥n
        document.getElementById('new-analysis').addEventListener('click', function() {
            window.location.href = 'index.html';
        });
        
        document.getElementById('export-report').addEventListener('click', function() {
            // Funcionalidad para exportar reporte
            alert('Funcionalidad de exportaci√≥n en desarrollo');
        });
        
        document.getElementById('save-results').addEventListener('click', function() {
            // Funcionalidad para guardar resultados
            alert('Resultados guardados exitosamente');
        });
        
        // Animaci√≥n de entrada para las tarjetas
        document.addEventListener('DOMContentLoaded', function() {
            // Cargar texto analizado desde localStorage
            loadAnalyzedText();
            
            // Animaciones
            const cards = document.querySelectorAll('.summary-card, .pattern-item, .recommendation-item');
            cards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });

        // Funci√≥n para cargar el texto analizado
        function loadAnalyzedText() {
            const analyzedText = localStorage.getItem('analyzedText');
            
            if (analyzedText) {
                // Mostrar el texto analizado
                document.getElementById('analyzed-text').textContent = analyzedText;
                
                // Calcular estad√≠sticas
                const charCount = analyzedText.length;
                const wordCount = analyzedText.trim().split(/\s+/).filter(word => word.length > 0).length;
                const lineCount = analyzedText.split('\n').length;
                
                // Actualizar estad√≠sticas
                document.getElementById('char-count').textContent = charCount;
                document.getElementById('word-count').textContent = wordCount;
                document.getElementById('line-count').textContent = lineCount;
                
                // Simular an√°lisis b√°sico
                performBasicAnalysis(analyzedText);
            } else {
                // Si no hay texto, mostrar mensaje y redirigir
                alert('No hay texto para analizar. Ser√° redirigido al inicio.');
                window.location.href = 'index.html';
            }
        }

        // Funci√≥n para realizar an√°lisis b√°sico del texto
        function performBasicAnalysis(text) {
            // Palabras potencialmente problem√°ticas (b√°sico)
            const problematicWords = [
                'idiota', 'est√∫pido', 'tonto', 'feo', 'gordo', 'perdedor', 'fracasado', 
                'in√∫til', 'nadie te quiere', 'vete a morir', 'te voy a pegar', 'c√°llate',
                'eres un', 'no sirves', 'me da asco', 'pat√©tico', 'monstruo'
            ];
            
            const textLower = text.toLowerCase();
            let foundPatterns = [];
            let riskLevel = 0;
            
            // Buscar patrones
            problematicWords.forEach(word => {
                if (textLower.includes(word.toLowerCase())) {
                    foundPatterns.push(word);
                    // Asignar puntos de riesgo seg√∫n la gravedad
                    if (['vete a morir', 'te voy a pegar'].includes(word)) {
                        riskLevel += 30;
                    } else if (['idiota', 'est√∫pido', 'in√∫til', 'nadie te quiere'].includes(word)) {
                        riskLevel += 20;
                    } else {
                        riskLevel += 10;
                    }
                }
            });
            
            // Actualizar porcentajes basados en el an√°lisis
            const safePercentage = Math.max(0, 100 - riskLevel);
            const warningPercentage = Math.min(riskLevel, 50);
            const dangerPercentage = Math.max(0, riskLevel - 50);
            
            document.getElementById('safe-percentage').textContent = safePercentage + '%';
            document.getElementById('warning-percentage').textContent = warningPercentage + '%';
            document.getElementById('danger-percentage').textContent = dangerPercentage + '%';
            
            // Actualizar descripciones seg√∫n el riesgo
            updateRiskDescriptions(riskLevel, foundPatterns.length);
        }

        // Funci√≥n para actualizar descripciones seg√∫n el nivel de riesgo
        function updateRiskDescriptions(riskLevel, patternsFound) {
            const safeCard = document.querySelector('.summary-card.safe .description');
            const warningCard = document.querySelector('.summary-card.warning .description');
            const dangerCard = document.querySelector('.summary-card.danger .description');
            
            if (riskLevel === 0) {
                safeCard.textContent = 'No se detectaron patrones de ciberacoso';
                warningCard.textContent = 'Sin contenido sospechoso';
                dangerCard.textContent = 'Sin contenido peligroso';
            } else if (riskLevel <= 30) {
                safeCard.textContent = 'Mayormente seguro con observaciones menores';
                warningCard.textContent = `${patternsFound} patr√≥n(es) de riesgo bajo detectado(s)`;
                dangerCard.textContent = 'Sin contenido altamente peligroso';
            } else if (riskLevel <= 60) {
                safeCard.textContent = 'Contenido con riesgos moderados';
                warningCard.textContent = `${patternsFound} patr√≥n(es) requieren atenci√≥n`;
                dangerCard.textContent = 'Algunos patrones de alto riesgo detectados';
            } else {
                safeCard.textContent = 'Contenido con alto riesgo de ciberacoso';
                warningCard.textContent = 'M√∫ltiples patrones problem√°ticos';
                dangerCard.textContent = `${patternsFound} patrones de ciberacoso confirmados`;
            }
        }
    </script>
</body>
</html>
