<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeText - Sistema de Detección de Ciberacoso Escolar</title>
    <link rel="stylesheet" href="../static/styles.css">
</head>
<body>
    <header>
        <div class="header-content">
            <h1>SafeText <span class="subtitle">Sistema de Detección de Ciberacoso Escolar</span></h1>
        </div>
        <div class="header-year">
            <span>EPN 2025</span>
        </div>
    </header>

    <main>
        <div class="main-container">
            <div class="input-section">
                <h3>Ingresa el Texto.</h3>
                
                <div class="text-input-container">
                    <div class="textarea-wrapper">
                        <textarea 
                            id="text-input" 
                            placeholder="Copia o Escribe aquí..."
                            rows="15"
                            cols="50"
                            maxlength="5000"
                        ></textarea>
                        <div class="character-counter">
                            <span id="char-count">0</span> / 5,000 caracteres
                        </div>
                    </div>
                    
                    <div class="file-upload-section">
                        <div class="file-drop-area" id="file-drop-area">
                            <p>Arrastra aquí tus archivos...</p>
                        </div>
                        
                        <button class="btn-secondary" id="upload-btn">Cargar Archivos</button>
                        <button class="btn-secondary" id="options-btn">Opciones</button>
                        
                        <input type="file" id="file-input" multiple accept=".txt,.doc,.docx" style="display: none;">
                    </div>
                </div>
                
                <button class="btn-primary" id="analyze-btn">Analizar</button>
            </div>
        </div>
        
        <!-- Sección de información del proyecto centrada -->
        <div class="project-info-section">
            <div class="project-description">
                <p>Este proyecto ha sido desarrollado sin fines de lucro, con el propósito de poner a prueba algoritmos de búsqueda de patrones aplicados a la detección de mensajes de odio. Para utilizarlo, simplemente copia tu texto o sube un archivo con los mensajes. Además, tienes la opción de agregar tus propios patrones personalizados para ampliar la detección.</p>
            </div>
            
            <div class="about-link">
                <a href="#" id="about-us">About us</a>
            </div>
        </div>
    </main>

    <!-- Pie de página -->
    <footer>
        <div class="footer-content">
            <p>&copy; 2025 SafeText - Sistema de Detección de Ciberacoso Escolar</p>
            <p>Creado por <strong>Harry Guajan</strong> y <strong>Joel Tinitana</strong></p>
            <p>Escuela Politécnica Nacional (EPN) - Estructura de Datos y Algoritmos II</p>
            <div class="footer-links">
                <a href="#" class="footer-link">Términos de Uso</a>
                <span class="separator">•</span>
                <a href="#" class="footer-link">Política de Privacidad</a>
                <span class="separator">•</span>
                <a href="#" class="footer-link">Contacto</a>
            </div>
        </div>
    </footer>

    <script>
        // Contador de caracteres
        const textInput = document.getElementById('text-input');
        const charCount = document.getElementById('char-count');
        
        function updateCharCount() {
            const currentLength = textInput.value.length;
            charCount.textContent = currentLength;
            
            // Cambiar color cuando se acerque al límite
            if (currentLength > 4500) {
                charCount.style.color = '#e74c3c';
            } else if (currentLength > 4000) {
                charCount.style.color = '#f39c12';
            } else {
                charCount.style.color = '#666';
            }
        }
        
        textInput.addEventListener('input', updateCharCount);
        textInput.addEventListener('paste', function() {
            setTimeout(updateCharCount, 10);
        });

        // Funcionalidad de los botones
        
        // Botón Analizar - lleva a resultados
        document.getElementById('analyze-btn').addEventListener('click', function() {
            const text = textInput.value.trim();
            
            if (!text) {
                alert('Por favor, ingrese algún texto para analizar');
                return;
            }
            
            // Guardar el texto en localStorage para usarlo en la página de resultados
            localStorage.setItem('analyzedText', text);
            
            // Redirigir a la página de resultados
            window.location.href = 'resultados.html';
        });

        // Botón Opciones - lleva a configuración
        document.getElementById('options-btn').addEventListener('click', function() {
            window.location.href = 'config.html';
        });

        // Botón Cargar Archivos
        document.getElementById('upload-btn').addEventListener('click', function() {
            document.getElementById('file-input').click();
        });

        // Manejar selección de archivos
        document.getElementById('file-input').addEventListener('change', function(event) {
            const files = event.target.files;
            
            if (files.length > 0) {
                const file = files[0];
                
                // Verificar si es un archivo de texto
                if (file.type === 'text/plain' || file.name.endsWith('.txt')) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        const content = e.target.result;
                        
                        // Verificar límite de caracteres
                        if (content.length > 5000) {
                            alert('El archivo es demasiado grande. El límite es de 5,000 caracteres.');
                            return;
                        }
                        
                        textInput.value = content;
                        updateCharCount();
                    };
                    
                    reader.readAsText(file);
                } else {
                    alert('Por favor, seleccione un archivo de texto (.txt)');
                }
            }
        });

        // Funcionalidad drag and drop
        const fileDropArea = document.getElementById('file-drop-area');

        fileDropArea.addEventListener('dragover', function(e) {
            e.preventDefault();
            fileDropArea.classList.add('dragover');
        });

        fileDropArea.addEventListener('dragleave', function(e) {
            e.preventDefault();
            fileDropArea.classList.remove('dragover');
        });

        fileDropArea.addEventListener('drop', function(e) {
            e.preventDefault();
            fileDropArea.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            
            if (files.length > 0) {
                const file = files[0];
                
                if (file.type === 'text/plain' || file.name.endsWith('.txt')) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        const content = e.target.result;
                        
                        if (content.length > 5000) {
                            alert('El archivo es demasiado grande. El límite es de 5,000 caracteres.');
                            return;
                        }
                        
                        textInput.value = content;
                        updateCharCount();
                    };
                    
                    reader.readAsText(file);
                } else {
                    alert('Por favor, arrastre un archivo de texto (.txt)');
                }
            }
        });

        // About us
        document.getElementById('about-us').addEventListener('click', function(e) {
            e.preventDefault();
            alert('SafeText - Sistema de Detección de Ciberacoso Escolar\n\nDesarrollado por Harry Guajan y Joel Tinitana\nEscuela Politécnica Nacional (EPN)\nEstructura de Datos y Algoritmos II\n\nEste sistema utiliza algoritmos avanzados de búsqueda de patrones para detectar y prevenir situaciones de ciberacoso en entornos educativos.');
        });
    </script>
</body>
</html>
